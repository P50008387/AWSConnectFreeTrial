(this.webpackJsonpTranslateBlog=this.webpackJsonpTranslateBlog||[]).push([[0],{185:function(t,n,e){},186:function(t,n,e){},188:function(t,n,e){},193:function(t,n){},251:function(t,n,e){var a={"./amplify-amazon-button_5.entry.js":[273,16],"./amplify-auth-container.entry.js":[274,17],"./amplify-auth-fields_9.entry.js":[275,18],"./amplify-authenticator.entry.js":[276,5],"./amplify-button_3.entry.js":[277,19],"./amplify-chatbot.entry.js":[278,4],"./amplify-checkbox.entry.js":[279,20],"./amplify-confirm-sign-in_7.entry.js":[280,6],"./amplify-container.entry.js":[281,21],"./amplify-federated-buttons_2.entry.js":[282,22],"./amplify-federated-sign-in.entry.js":[283,23],"./amplify-form-field_4.entry.js":[284,24],"./amplify-greetings.entry.js":[285,25],"./amplify-icon-button.entry.js":[286,26],"./amplify-icon.entry.js":[287,7],"./amplify-link.entry.js":[288,27],"./amplify-nav_2.entry.js":[289,28],"./amplify-photo-picker.entry.js":[290,29],"./amplify-picker.entry.js":[291,30],"./amplify-radio-button_3.entry.js":[292,8],"./amplify-s3-album.entry.js":[293,9],"./amplify-s3-image-picker.entry.js":[294,10],"./amplify-s3-image.entry.js":[295,11],"./amplify-s3-text-picker.entry.js":[296,12],"./amplify-s3-text.entry.js":[297,13],"./amplify-select-mfa-type.entry.js":[298,31],"./amplify-sign-in-button.entry.js":[299,14],"./amplify-tooltip.entry.js":[300,32]};function c(t){if(!e.o(a,t))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=a[t],c=n[0];return e.e(n[1]).then((function(){return e(c)}))}c.keys=function(){return Object.keys(a)},c.id=251,t.exports=c},255:function(t,n,e){"use strict";e.r(n);var a=e(8),c=e.n(a),r=e(149),o=e.n(r),s=(e(185),e(150)),i=e(151),u=e(169),l=e(168),p=e(38),f=e(331),d={aws_project_region:"us-east-1",aws_cognito_identity_pool_id:"us-east-1:516fb6b4-afd5-4531-8bf2-a6935d970197",aws_cognito_region:"us-east-1",aws_user_pools_id:"us-east-1_0rOcwH7Ua",aws_user_pools_web_client_id:"231l46ihggg971f9mc99uqcrv0",oauth:{},aws_cloud_logic_custom:[{name:"amazonTranslateAPI",endpoint:"https://mqbog9r05i.execute-api.us-east-1.amazonaws.com/dev",region:"us-east-1"}],aws_appsync_graphqlEndpoint:"https://k45utokmqrcu5b5rgbatvsx7ne.appsync-api.us-east-1.amazonaws.com/graphql",aws_appsync_region:"us-east-1",aws_appsync_authenticationType:"API_KEY",aws_appsync_apiKey:"da2-in5rzn5wijekfcwt6cyc3e5bte",predictions:{convert:{translateText:{region:"us-east-1",proxy:!1,defaults:{sourceLanguage:"en",targetLanguage:"de"}}},interpret:{interpretText:{region:"us-east-1",proxy:!1,defaults:{type:"ALL"}}}}},g=(e(186),e(119),e(25)),h=e.n(g),b=e(66),j=e(85),y=e(49),m=e(35),v=e(330),O=e(68),x=e(244),C=(e(188),e(15)),w=function(t){var n=t.chat,e=t.user;return Object(C.jsxs)("li",{className:"chat ".concat(e===n.username?"right":"left"),children:[n.content,Object(C.jsx)("li",{className:"translatedMessage",children:n.translatedMessage})]})},k=e(64);function I(){return(I=Object(y.a)(h.a.mark((function t(n,e,a){var c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.a.convert({translateText:{source:{text:n,language:e},targetLanguage:a}});case 2:return c=t.sent,t.abrupt("return",c.text);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var T=function(t,n,e){return I.apply(this,arguments)},_=e(148);function E(){return(E=Object(y.a)(h.a.mark((function t(n,e,a,c){var r,o;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"amazonTranslateAPI","/translate",r={body:{content:n,sourceLang:e,targetLang:a,terminologyNames:c},headers:{}},console.log("myInit :",r),t.prev=4,t.next=7,_.a.post("amazonTranslateAPI","/translate",r);case 7:return o=t.sent,console.log("ProcessChatTextAPI: ",o),t.abrupt("return",o);case 12:return t.prev=12,t.t0=t.catch(4),console.error("ProcessChatTextAPI: ",t.t0),t.abrupt("return",t.t0);case 16:case"end":return t.stop()}}),t,null,[[4,12]])})))).apply(this,arguments)}var D=function(t,n,e,a){return E.apply(this,arguments)},A=e(158),S=Object(A.a)({languageTranslate:[],Chats:[],currentContactId:"none",languageOptions:{Afrikaans:"af",Albanian:"sq",Amharic:"am",Arabic:"ar",Armenian:"hy",Azerbaijani:"az",Bengali:"bn",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca","Chinese (Simplified)":"zh","Chinese (Traditional)":"zh-TW",Croatian:"hr",Czech:"cs",Danish:"da",Dari:"fa-AF",Dutch:"nl",English:"en",Estonian:"et","Farsi (Persian)":"fa","Filipino Tagalog":"tl",Finnish:"fi",French:"fr","French (Canada)":"fr-CA",Georgian:"ka",German:"de",Greek:"el",Gujarati:"gu","Haitian Creole":"ht",Hausa:"ha",Hebrew:"he",Hindi:"hi",Hungarian:"hu",Icelandic:"is",Indonesian:"id",Italian:"it",Japanese:"ja",Kannada:"kn",Kazakh:"kk",Korean:"ko",Latvian:"lv",Lithuanian:"lt",Macedonian:"mk",Malay:"ms",Malayalam:"ml",Maltese:"mt",Mongolian:"mn",Norwegian:"no",Persian:"fa",Pashto:"ps",Polish:"pl",Portuguese:"pt",Romanian:"ro",Russian:"ru",Serbian:"sr",Sinhala:"si",Slovak:"sk",Slovenian:"sl",Somali:"so",Spanish:"es","Spanish (Mexico)":"es-MX",Swahili:"sw",Swedish:"sv",Tagalog:"tl",Tamil:"ta",Telugu:"te",Thai:"th",Turkish:"tr",Ukrainian:"uk",Urdu:"ur",Uzbek:"uz",Vietnamese:"vi",Welsh:"cy"}}),G=S.setGlobalState,B=S.useGlobalState,U=function(t,n){G("Chats",t)},M=function(t){G("languageTranslate",t)},P=function(t){G("currentContactId",t)},N=function(t){var n=B("Chats"),e=Object(m.a)(n,1)[0],c=B("currentContactId"),r=Object(a.useState)(""),o=Object(m.a)(r,2),s=o[0],i=o[1],u=B("languageTranslate"),l=Object(m.a)(u,1)[0],p=B("languageOptions"),f=Object(m.a)(p,1)[0],d="AGENT",g=Object(a.useRef)(null),b=Object(a.useRef)(null);var v=function(){var t=Object(y.a)(h.a.mark((function t(n,e){var a,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.sendMessage({contentType:"text/plain",message:e});case 3:a=t.sent,c=a.data,c.AbsoluteTime,c.Id,t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(n,e){return t.apply(this,arguments)}}();function O(){return(O=Object(y.a)(h.a.mark((function n(e){var a,r,o,u,p,f;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(f=function(n){var e="";for(var a in t.session)for(var c in t.session[a])if(c===n){e=t.session[a][c];break}return e},e.preventDefault(),""!==s){n.next=4;break}return n.abrupt("return");case 4:return a=l.find((function(t){return t.contactId===c[0]})),n.prev=5,n.next=8,D(s,"en",a.lang,["connectChatTranslate"]);case 8:r=n.sent,o=r.TranslatedText,n.next=15;break;case 12:n.prev=12,n.t0=n.catch(5),o=s;case 15:console.log(" Original Message: "+s+"\n Translated Message: "+o),u={contactId:c[0],username:d,content:Object(C.jsx)("p",{children:s}),translatedMessage:Object(C.jsx)("p",{children:o})},U((function(t){return[].concat(Object(j.a)(t),[u])})),i(""),p=f(c[0]),v(p,o);case 22:case"end":return n.stop()}}),n,null,[[5,12]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){g&&g.current.addEventListener("DOMNodeInserted",(function(t){var n=t.currentTarget;n.scroll({top:n.scrollHeight,behavior:"smooth"})})),b.current.focus()}),[]),Object(C.jsxs)("div",{className:"chatroom",children:[Object(C.jsxs)("h3",{children:["Translate - (",l.map((function(t){if(t.contactId===c[0])return t.lang})),") ",function(t){var n=l.find((function(t){return t.contactId===c[0]}));return void 0===n?void 0:Object.keys(t).find((function(e){return t[e]===n.lang}))}(f)]}),Object(C.jsx)("ul",{className:"chats",ref:g,children:e.map((function(t){if(t.contactId===c[0])return Object(C.jsx)(w,{chat:t,user:d})}))}),Object(C.jsxs)("form",{className:"input",onSubmit:function(t){return O.apply(this,arguments)},children:[Object(C.jsx)("input",{ref:b,maxLength:"1024",type:"text",value:s,onChange:function(t){return i(t.target.value)}}),Object(C.jsx)("input",{type:"submit",value:"Submit"})]})]})};function L(){return(L=Object(y.a)(h.a.mark((function t(n){var e;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=k.a.interpret({text:{source:{text:n},type:"ALL"}}),t.abrupt("return",e);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var z=function(t){return L.apply(this,arguments)};O.default.configure(d),O.default.addPluggable(new x.a);var F=function(){var t=B("languageTranslate"),n=Object(m.a)(t,1)[0],e=[],c=B("Chats"),r=(Object(m.a)(c,1)[0],Object(a.useState)("")),o=Object(m.a)(r,2),s=(o[0],o[1],B("currentContactId")),i=(Object(m.a)(s,1)[0],B("languageOptions")),u=Object(m.a)(i,1)[0],l=Object(a.useState)([]),p=Object(m.a)(l,2),f=p[0],d=p[1],g=Object(a.useState)([]),O=Object(m.a)(g,1)[0];function x(t,n){t.getAgentConnection().getMediaController().then((function(t){t.onMessage((function(t){t.chatDetails.participantId===t.data.ParticipantId?console.log("CDEBUG ===> Agent ".concat(t.data.DisplayName," Says"),t.data.Content):(console.log("CDEBUG ===> Customer ".concat(t.data.DisplayName," Says"),t.data.Content),function(t,n,e){w.apply(this,arguments)}(t.data.Content,t.data.Type,t.data.ContactId))}))}))}function w(){return(w=Object(y.a)(h.a.mark((function t(a,c,r){var o,s,i,u,l,p;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u=function(t,n){var e=t.findIndex((function(t){return t.contactId===n.contactId}));e>-1?t[e]=n:t.push(n)},o="",s=0;case 3:if(!(s<n.length)){t.next=10;break}if(n[s].contactId!=r){t.next=7;break}return o=n[s].lang,t.abrupt("break",10);case 7:s++,t.next=3;break;case 10:if(0!=e.length&&""!=o){t.next=15;break}return t.next=13,z(a);case 13:i=t.sent,o=i.textInterpretation.language;case 15:return u(n,{contactId:r,lang:o}),M(n),t.next=19,T(a,o,"en");case 19:l=t.sent,console.log("CDEBUG ===>  Original Message: "+a+"\n Translated Message: "+l),p={contactId:r,username:"customer",content:Object(C.jsx)("p",{children:a}),translatedMessage:Object(C.jsx)("p",{children:l})},U((function(t){return[].concat(Object(j.a)(t),[p])}));case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(){window.connect.core.onViewContact((function(t){var n=t.contactId;console.log("CDEBUG ===> onViewContact",n),P(n)})),console.log("CDEBUG ===> subscribeConnectEvents"),window.connect.ChatSession?(console.log("CDEBUG ===> Subscribing to Connect Contact Events for chats"),window.connect.contact((function(t){t.onConnecting((function(){console.log("CDEBUG ===> onConnecting() >> contactId: ",t.contactId);var n=t.getAttributes();console.log("CDEBUG ===> contactAttributes: ",JSON.stringify(n));var e=t.getQueue();console.log("CDEBUG ===> contactQueue: ",e)})),t.onAccepted(Object(y.a)(h.a.mark((function a(){var c,r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("CDEBUG ===> onAccepted: ",t),c=t.getConnections().find((function(t){return t.getType()===window.connect.ConnectionType.AGENT})),a.next=4,c.getMediaController();case 4:r=a.sent,P(t.contactId),console.log("CDEBUG ===> agentChatSession ",r);try{d((function(n){return[].concat(Object(j.a)(n),[Object(b.a)({},t.contactId,r)])})),e=t.getAttributes().x_lang.value}catch(o){console.log("")}void 0!==Object.keys(u).find((function(t){return u[t]===e}))&&(console.log("CDEBUG ===> Setting lang code from attribites:",e),n.push({contactId:t.contactId,lang:e}),M(n),O("updated")),console.log("CDEBUG ===> onAccepted, languageTranslate ",n);case 10:case"end":return a.stop()}}),a)})))),t.onConnected(Object(y.a)(h.a.mark((function n(){var e;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("CDEBUG ===> onConnected() >> contactId: ",t.contactId),e=t.getConnections().find((function(t){return t.getType()===window.connect.ConnectionType.AGENT})),n.next=4,e.getMediaController();case 4:n.sent,x(t);case 6:case"end":return n.stop()}}),n)})))),t.onRefresh((function(){console.log("CDEBUG ===> onRefresh() >> contactId: ",t.contactId)})),t.onEnded((function(){console.log("CDEBUG ===> onEnded() >> contactId: ",t.contactId)})),t.onDestroy((function(){console.log("CDEBUG ===> onDestroy() >> contactId: ",t.contactId),P("")}))})),console.log("CDEBUG ===> Subscribing to Connect Agent Events"),window.connect.agent((function(t){t.onStateChange((function(t){var n=t.newState;console.log("CDEBUG ===> New State: ",n)}))}))):(console.log("CDEBUG ===> waiting 3s"),setTimeout((function(){k()}),3e3))}return Object(a.useEffect)((function(){window.connect.agentApp.initApp("ccp","ccp-container","https://capitachat.my.connect.aws/connect/ccp-v2/",{ccpParams:{region:"us-east-1",pageOptions:{enableAudioDeviceSettings:!0,enablePhoneTypeSettings:!0}}}),k()}),[]),Object(C.jsx)("main",{children:Object(C.jsx)(v.a,{columns:"equal",stackable:!0,padded:!0,children:Object(C.jsxs)(v.a.Row,{children:[Object(C.jsx)("div",{id:"ccp-container"}),Object(C.jsxs)("div",{id:"chatroom",children:[Object(C.jsx)(N,{session:f})," "]})]})})})};p.a.configure(d);var q=function(t){Object(u.a)(e,t);var n=Object(l.a)(e);function e(){return Object(s.a)(this,e),n.apply(this,arguments)}return Object(i.a)(e,[{key:"render",value:function(){return Object(C.jsx)("div",{className:"App",children:Object(C.jsx)(F,{})})}}]),e}(a.Component),H=Object(f.a)(q),R=function(t){t&&t instanceof Function&&e.e(35).then(e.bind(null,344)).then((function(n){var e=n.getCLS,a=n.getFID,c=n.getFCP,r=n.getLCP,o=n.getTTFB;e(t),a(t),c(t),r(t),o(t)}))};e(252),e(253);O.default.configure(d),o.a.render(Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(H,{})}),document.getElementById("root")),R()}},[[255,2,3]]]);
//# sourceMappingURL=main.753f7350.chunk.js.map